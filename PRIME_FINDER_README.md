# 大范围质数查找器

## 项目简介

这是一个用于在超大范围内查找质数的Python程序，专门设计用于遍历 **1×10¹² 到 2×10¹²-1** 范围内的所有质数。

## 文件说明

- `prime_range_finder.py` - 主程序，用于查找指定范围内的质数
- `test_prime_finder.py` - 测试程序，验证算法的正确性
- `prime_13bits.csv` - 输出文件（程序运行后生成）

## 功能特性

### 1. 高效算法
- 使用 **6k±1 优化** 的质数判断算法
- 只检查奇数，跳过所有偶数
- 只检查到 √n，大幅减少计算量

### 2. 性能优化
- **批量写入CSV**：减少I/O操作次数
- **实时进度显示**：每检查1000万个数字显示一次进度
- **速度监控**：显示实时处理速度

### 3. 用户友好
- 清晰的进度报告
- 支持 Ctrl+C 中断（已找到的质数会保存）
- 详细的统计信息

## 使用方法

### 运行主程序

```bash
python prime_range_finder.py
```

程序会提示确认，因为完整遍历需要很长时间：

```
警告：此程序将遍历 1 万亿个数字，可能需要数小时甚至数天！
预计需要检查约 499,999,999,999 个奇数

是否继续运行？(yes/no):
```

输入 `yes` 开始运行。

### 运行测试程序

在运行主程序之前，建议先运行测试程序验证正确性：

```bash
python test_prime_finder.py
```

测试程序会：
1. 测试小范围（1000-1100）的质数查找
2. 测试万亿级别的样本（验证算法在大数上的正确性）

## 输出格式

程序会生成 `prime_13bits.csv` 文件，格式如下：

```csv
序号,质数
1,1000000000039
2,1000000000061
3,1000000000063
...
```

## 性能估算

### 测试结果
根据测试：
- 小范围测试（1000-1100）：约 50,000 个/秒
- 万亿级别测试：约 900 个/秒

### 完整运行估算

**范围**: 1×10¹² 到 2×10¹²-1（约5000亿个奇数需要检查）

**预计时间**（在现代PC上）：
- 如果速度为 900 个/秒：约 **6400 天**（不现实）
- 如果优化到 10,000 个/秒：约 **579 天**
- 如果使用高性能服务器达到 100,000 个/秒：约 **58 天**

**建议**：
1. 对于如此大的范围，建议使用更高级的算法（如分段筛法）
2. 或者使用并行计算（多核/多机器）
3. 或者缩小范围到更实际的规模

## 性能优化建议

如果需要完成完整遍历，可以考虑以下优化：

### 1. 使用分段筛法（Segmented Sieve）
```python
# 将大范围分成小段，对每段使用埃拉托斯特尼筛法
# 这比逐个判断要快得多
```

### 2. 并行处理
```python
# 使用 multiprocessing 将范围分给多个CPU核心
from multiprocessing import Pool
```

### 3. 使用PyPy或Cython
```bash
# PyPy可以提供2-10倍的速度提升
pypy3 prime_range_finder.py
```

### 4. 使用更高级的质数测试
- Miller-Rabin 素性测试（概率算法，速度更快）
- AKS 素性测试（确定性算法，但对此范围可能仍然较慢）

## 实际运行示例

### 示例1：测试小范围
```bash
$ python test_prime_finder.py
```

输出：
```
测试1: 查找 1000-1100 之间的质数
找到质数总数: 16
[OK] 测试通过！程序运行正常
```

### 示例2：修改范围运行
你可以修改 `prime_range_finder.py` 中的范围来测试更小的区间：

```python
# 原始范围
START = 1 * 10**12
END = 2 * 10**12 - 1

# 修改为更小的范围（例如：100亿到101亿）
START = 10 * 10**9
END = 10.1 * 10**9
```

## 中断与恢复

### 中断程序
按 `Ctrl+C` 可以随时中断程序。已找到的质数会自动保存到CSV文件中。

### 恢复功能
当前版本不支持断点续传。如果需要此功能，可以：
1. 记录程序中断时的位置
2. 修改 START 值从中断位置继续
3. 使用追加模式写入CSV（需要修改代码）

## 注意事项

⚠️ **重要提示**：

1. **磁盘空间**：1万亿范围内可能有数百亿个质数，CSV文件可能达到数百GB
2. **运行时间**：完整遍历可能需要数周甚至数月
3. **系统资源**：建议在专用服务器上运行，不要在个人电脑上运行完整程序
4. **数据备份**：定期备份生成的CSV文件

## 技术细节

### 算法复杂度
- **时间复杂度**: O(n × √n)，其中 n 是范围大小
- **空间复杂度**: O(1)（不考虑输出文件）

### 6k±1 优化原理
所有大于3的质数都可以表示为 6k±1 的形式：
- 6k+0 = 6k（能被6整除）
- 6k+1 ✓ 可能是质数
- 6k+2 = 2(3k+1)（能被2整除）
- 6k+3 = 3(2k+1)（能被3整除）
- 6k+4 = 2(3k+2)（能被2整除）
- 6k+5 = 6k-1 ✓ 可能是质数

因此我们只需要检查 6k±1 形式的数。

## 许可证

MIT License - 可自由使用和修改

## 作者

质数学习项目

## 更新日志

### v1.0 (2025-11-18)
- 初始版本
- 实现基本的质数遍历功能
- 添加进度显示和CSV输出
- 包含测试程序
