# 大范围质数查找器

## 项目简介

这是一个用于在超大范围内查找质数的Python程序，专门设计用于遍历 **1×10¹² 到 2×10¹²-1** 范围内的所有质数。

程序支持三种运行模式：
- **mini模式**：找到前10个质数（快速测试，约0.3秒）
- **pro模式**：找到前100个质数（中等测试，约3秒）
- **full模式**：完整遍历（需要数月时间，约962GB磁盘空间）

## 文件说明

- `prime_range_finder.py` - 主程序，用于查找指定范围内的质数
- `test_prime_finder.py` - 测试程序，验证算法的正确性
- `prime_13bits.csv` - 输出文件（程序运行后生成）

## 功能特性

### 1. 多种运行模式
- **mini模式**：快速找到前10个质数，适合快速验证
- **pro模式**：找到前100个质数，适合深度测试
- **full模式**：完整遍历整个范围（谨慎使用）

### 2. 智能预估
- 自动计算预计运行时间
- 自动估算所需磁盘空间
- 根据模式显示相应的警告信息

### 3. 高效算法
- 使用 **6k±1 优化** 的质数判断算法
- 只检查奇数，跳过所有偶数
- 只检查到 √n，大幅减少计算量

### 4. 性能优化
- **批量写入CSV**：减少I/O操作次数
- **实时进度显示**：每检查1000万个数字显示一次进度
- **速度监控**：显示实时处理速度

### 5. 用户友好
- 命令行参数支持
- 清晰的进度报告
- 支持 Ctrl+C 中断（已找到的质数会保存）
- 详细的统计信息

## 使用方法

### 查看帮助信息

```bash
python prime_range_finder.py --help
```

### 运行不同模式

#### Mini模式（推荐新用户）
找到前10个质数，运行时间约0.3秒：

```bash
python prime_range_finder.py --mode mini
```

#### Pro模式（中等测试）
找到前100个质数，运行时间约3秒：

```bash
python prime_range_finder.py --mode pro
```

#### Full模式（完整遍历，谨慎使用）
遍历整个范围，预计需要约6430天（214个月），磁盘空间约962GB：

```bash
python prime_range_finder.py --mode full
```

### 默认模式
如果不指定模式，默认使用mini模式：

```bash
python prime_range_finder.py
```

### 运行测试程序

在运行主程序之前，建议先运行测试程序验证正确性：

```bash
python test_prime_finder.py
```

测试程序会：
1. 测试小范围（1000-1100）的质数查找
2. 测试万亿级别的样本（验证算法在大数上的正确性）

## 输出格式

程序会生成 `prime_13bits.csv` 文件，格式如下：

```csv
序号,质数
1,1000000000039
2,1000000000061
3,1000000000063
...
```

## 性能估算

### 各模式的实际表现

根据实际测试结果：

| 模式 | 质数数量 | 运行时间 | 磁盘空间 | 适用场景 |
|------|---------|---------|---------|---------|
| **mini** | 10个 | 约0.3秒 | 约0.3KB | 快速验证、新用户测试 |
| **pro** | 100个 | 约3秒 | 约3KB | 深度测试、算法验证 |
| **full** | 约344亿个 | 约6430天 | 约962GB | 科研项目、需要完整数据 |

### 完整模式详细估算

**范围**: 1×10¹² 到 2×10¹²-1（约5000亿个奇数需要检查）

**预计结果**：
- 质数数量：约 34,419,869,166 个（根据质数定理）
- 运行时间：约 6430 天（214个月，17.6年）
- 磁盘空间：约 962 GB

**重要提示**：
1. **不推荐在个人电脑上运行full模式**
2. 建议使用mini或pro模式进行验证
3. 如需完整数据，考虑使用更高级的算法或分布式计算
4. 实际运行时间可能因硬件配置而有很大差异

## 性能优化建议

如果需要完成完整遍历，可以考虑以下优化：

### 1. 使用分段筛法（Segmented Sieve）
```python
# 将大范围分成小段，对每段使用埃拉托斯特尼筛法
# 这比逐个判断要快得多
```

### 2. 并行处理
```python
# 使用 multiprocessing 将范围分给多个CPU核心
from multiprocessing import Pool
```

### 3. 使用PyPy或Cython
```bash
# PyPy可以提供2-10倍的速度提升
pypy3 prime_range_finder.py
```

### 4. 使用更高级的质数测试
- Miller-Rabin 素性测试（概率算法，速度更快）
- AKS 素性测试（确定性算法，但对此范围可能仍然较慢）

## 实际运行示例

### 示例1：Mini模式运行
```bash
$ python prime_range_finder.py --mode mini
```

输出：
```
======================================================================
大范围质数查找器
======================================================================
运行模式: MINI - 快速模式（前10个质数）
查找范围: 1,000,000,000,000 到 1,999,999,999,999

【预估信息】
预计找到质数: 10 个
预计运行时间: 0.31 秒
预计磁盘空间: 0.29 KB
输出文件: prime_13bits.csv

确认以 MINI 模式运行？(yes/no): yes

已找到 10 个质数，达到限制，停止遍历
找到质数总数: 10
```

生成的CSV文件内容：
```csv
序号,质数
1,1000000000039
2,1000000000061
3,1000000000063
4,1000000000091
5,1000000000121
6,1000000000163
7,1000000000169
8,1000000000177
9,1000000000189
10,1000000000193
```

### 示例2：Pro模式运行
```bash
$ python prime_range_finder.py --mode pro
```

找到100个质数，运行时间约1-3秒。

### 示例3：测试程序
```bash
$ python test_prime_finder.py
```

输出：
```
测试1: 查找 1000-1100 之间的质数
找到质数总数: 16
[OK] 测试通过！程序运行正常
```

## 中断与恢复

### 中断程序
按 `Ctrl+C` 可以随时中断程序。已找到的质数会自动保存到CSV文件中。

### 恢复功能
当前版本不支持断点续传。如果需要此功能，可以：
1. 记录程序中断时的位置
2. 修改 START 值从中断位置继续
3. 使用追加模式写入CSV（需要修改代码）

## 注意事项

⚠️ **重要提示**：

### 关于不同模式

1. **Mini模式（推荐）**：
   - 适合快速测试和验证
   - 运行时间短，资源占用少
   - 推荐新用户首次使用

2. **Pro模式**：
   - 适合算法测试和性能评估
   - 可以获得足够的数据样本
   - 运行时间可接受（几秒钟）

3. **Full模式（极度谨慎）**：
   - 需要约17.6年的运行时间
   - 需要约962GB的磁盘空间
   - 强烈不推荐在个人电脑上运行
   - 仅适合科研项目或需要完整数据集的场景
   - 建议考虑使用分段筛法或分布式计算

### 一般注意事项

1. **磁盘空间**：运行前确保有足够的磁盘空间
2. **中断保存**：按Ctrl+C中断时，已找到的质数会自动保存
3. **数据备份**：对于长时间运行，建议定期备份CSV文件
4. **性能差异**：实际运行时间会因CPU性能而有较大差异

## 技术细节

### 算法复杂度
- **时间复杂度**: O(n × √n)，其中 n 是范围大小
- **空间复杂度**: O(1)（不考虑输出文件）

### 6k±1 优化原理
所有大于3的质数都可以表示为 6k±1 的形式：
- 6k+0 = 6k（能被6整除）
- 6k+1 ✓ 可能是质数
- 6k+2 = 2(3k+1)（能被2整除）
- 6k+3 = 3(2k+1)（能被3整除）
- 6k+4 = 2(3k+2)（能被2整除）
- 6k+5 = 6k-1 ✓ 可能是质数

因此我们只需要检查 6k±1 形式的数。

## 许可证

MIT License - 可自由使用和修改

## 作者

质数学习项目

## 更新日志

### v1.0 (2025-11-18)
- 初始版本
- 实现基本的质数遍历功能
- 添加进度显示和CSV输出
- 包含测试程序
